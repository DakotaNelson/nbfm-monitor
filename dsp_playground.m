samp_freq = 256;
signal_freq = 50;
buflen = 256;
duration = buflen/samp_freq;

t = [0:(buflen-1)];

#x_test = sin(2*pi*t / (samp_freq/signal_freq));
x = sinetone(signal_freq, samp_freq, duration)
f = fft(transpose(x));
f_mag = abs(f);

window = hamming(buflen);
x_hammed = x .* window;
f_ham = fft(x_hammed);
f_ham_mag = abs(f_ham);

#f_ham_shifted = fftshift(f_ham);
#f_ham_shifted_test = horzcat(f_ham(ceil((buflen-1)/2):-1:1), 0, f_ham(1:floor((buflen-1)/2)));

horiz_axis_increment = samp_freq/buflen;
dft_horiz_axis = 0:horiz_axis_increment:((samp_freq/2)-horiz_axis_increment);

psd = abs(f_ham_mag) / sqrt(buflen); # normalize the FFT
psd_log = log10(psd) .* 10; # convert to dB

psd_horiz_axis_step = samp_freq/buflen;
psd_horiz_axis = 0:psd_horiz_axis_step:(samp_freq/2)-psd_horiz_axis_step;

[psd_comparison, psd_comparison_range] = periodogram(x, hamming(buflen), buflen, samp_freq);
psd_comparison_log = log10(psd_comparison) .* 10; # convert to dB

# plot the waveform
subplot(5,1,1);
plot(x(1:200));
title("Samples of Waveform");
xlabel("Sample Number");

# plot the FFT
subplot(5,1,2);
plot(dft_horiz_axis, f_ham_mag(1:buflen/2));
title("Magnitude of FFT");
xlabel("Frequency (Hz)");

# plot the PSD
subplot(5,1,3);
plot(psd_horiz_axis, psd_log(1:(buflen/2)));
title("PSD")
ylabel("Power (dB)");
xlabel("Frequency (Hz)");

subplot(5,1,4);
plot(psd_comparison_range, psd_comparison_log);
title("Periodogram");
ylabel("Power (dB)");
xlabel("Frequency (Hz)");


####################################

rust_output = [-54.455948, -55.44568, -55.46691, -53.900913, -53.48486, -55.84262, -54.62245, -54.55017, -54.191837, -54.72162, -55.28938, -54.461662, -55.55458, -53.714325, -53.53701, -56.009525, -52.81151, -55.037666, -55.493538, -51.677227, -50.070107, -58.724518, -51.767593, -54.129253, -53.101765, -53.021656, -53.26526, -52.505585, -51.899372, -52.95875, -51.690247, -52.741543, -51.314827, -51.787598, -50.93654, -51.828026, -51.10295, -50.342552, -49.974968, -51.47666, -49.250946, -50.069168, -49.670883, -49.634773, -48.863235, -48.876175, -48.62742, -48.243263, -48.13999, -47.618732, -47.396164, -47.27224, -46.481815, -46.769295, -45.585083, -46.007454, -45.31477, -44.789505, -44.47886, -43.85448, -43.659115, -42.882275, -42.637627, -41.77569, -41.41475, -40.577793, -39.993935, -39.19108, -38.332294, -37.42296, -36.372974, -35.199604, -33.827145, -32.176445, -30.135601, -27.402996, -23.133999, 2.672024, 6.327055, 2.6720128, -23.135925, -27.403624, -30.132597, -32.175777, -33.82635, -35.18004, -36.40335, -37.40646, -38.386505, -39.142754, -39.977863, -40.67212, -41.339134, -41.939285, -42.5016, -42.955986, -43.693207, -43.922344, -44.528915, -44.982155, -45.372284, -45.501247, -46.497093, -46.370144, -46.84951, -47.332123, -47.296333, -48.050133, -48.392532, -48.22471, -49.097973, -48.571392, -49.952244, -49.12536, -50.21698, -50.150906, -50.447433, -50.75377, -49.569557, -53.688522, -49.145374, -50.676197, -51.988297, -52.109978, -51.56005, -51.850586, -51.569134, -52.340984, -52.404823, -52.329147, -51.564823, -51.863064, -51.56, -52.12004, -51.9783, -50.672165, -49.14537, -53.684155, -49.586147, -50.762184, -50.447353, -50.119797, -50.271873, -49.137894, -49.952248, -48.58718, -49.13891, -48.219856, -48.3925, -48.04623, -47.28279, -47.331486, -46.84951, -46.369938, -46.494415, -45.50184, -45.372284, -44.984528, -44.520576, -43.920486, -43.693207, -42.957077, -42.50607, -41.93705, -41.33914, -40.67276, -39.977097, -39.142776, -38.386505, -37.40695, -36.403847, -35.179955, -33.826355, -32.175972, -30.132597, -27.403542, -23.135925, 2.6720128, 6.327055, 2.672024, -23.133999, -27.403019, -30.135307, -32.17643, -33.827145, -35.19977, -36.373547, -37.42318, -38.332294, -39.191074, -39.99369, -40.57694, -41.41475, -41.776535, -42.643898, -42.880356, -43.659126, -43.854767, -44.47262, -44.78726, -45.31477, -46.00596, -45.590546, -46.76916, -46.481773, -47.28829, -47.399406, -47.617958, -48.13993, -48.2478, -48.651814, -48.859962, -48.86325, -49.635033, -49.67226, -50.060543, -49.250946, -51.48613, -49.991318, -50.341812, -51.102936, -51.822365, -50.908035, -51.768536, -51.314827, -52.750725, -51.724472, -52.992912, -51.89939, -52.515366, -53.239918, -53.0146, -53.10176, -54.132736, -51.799034, -58.697147, -50.07013, -51.707397, -55.493454, -55.0215, -52.81149, -55.95495, -53.422806, -53.81456, -55.55458, -54.459198, -55.22251, -54.714264, -54.19184, -54.537506, -54.663383, -55.859585, -53.4849, -53.93197, -55.4758, -55.520844];
subplot(5,1,5);
plot(fftshift(rust_output)(1:127));
title("Output of Rust Program");
ylabel("Power (dB)");
xlabel("Frequency (Hz)");
